<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head>
    <meta charset="UTF-8">
    <title>Dashboard de Juegos</title>

    <!-- Bootstrap por CDN -->
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">

    <!-- Hoja de estilos global -->
    <link rel="stylesheet" th:href="@{/css/app.css}">
</head>
<body class="dashboard-body">

<div class="container dash-container py-4">
    <!-- HEADER -->
    <header class="dash-header">
        <div>
            <span class="pill">Backlog de videojuegos</span>
            <h1>Dashboard</h1>
            <p class="subtitulo">
                Resumen de tu progreso, horas jugadas y puntajes.
            </p>
        </div>
        <div class="header-actions">
            <a th:href="@{/}" class="btn btn-outline-light btn-sm">Volver al inicio</a>
            <a th:href="@{/juegos/nuevo}" class="btn btn-success btn-sm">Agregar juego</a>
        </div>
    </header>

    <!-- RESUMEN POR ESTADO -->
    <section class="section">
        <h2>Resumen por estado</h2>
        <div class="card-table">
            <table>
                <thead>
                <tr>
                    <th>Estado</th>
                    <th>Total</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="row : ${estadisticasEstado}">
                    <td th:text="${row.estado}">COMPLETADO</td>
                    <td th:text="${row.total}">10</td>
                </tr>
                </tbody>
            </table>
        </div>
    </section>

    <!-- TOP JUEGOS POR HORAS -->
    <section class="section">
        <div class="section-header">
            <h2>Top [[${top}]] juegos por horas jugadas</h2>
        </div>

        <div class="cards-row">
            <div class="card-game" th:each="row : ${topHoras}">
                <!-- LINK al detalle del juego -->
                <a th:href="@{|/juegos/${row.juegoId}|}" class="card-link">

                    <div class="card-cover-wrapper">
                        <!-- Si hay portada, mostramos la imagen -->
                        <div class="card-cover"
                             th:if="${row.portada != null}"
                             th:style="'background-image: url(' + ${row.portada} + ');'">
                            <div class="card-hover">
                                <span>Ver detalle</span>
                            </div>
                        </div>

                        <!-- Si NO hay portada, un placeholder -->
                        <div class="card-cover placeholder" th:if="${row.portada == null}">
                            <span>Sin portada</span>
                        </div>
                    </div>

                    <div class="card-body">
                        <h3 th:text="${row.titulo}">Título del juego</h3>
                        <p class="meta">
                            <span class="label">Horas totales:</span>
                            <span th:text="${row.horasTotales}">0</span>
                        </p>
                    </div>
                </a>
            </div>
        </div>
    </section>

    <!-- PUNTAJE PROMEDIO POR JUEGO -->
    <section class="section">
        <h2>Puntaje promedio por juego</h2>

        <div class="cards-row">
            <div class="card-game" th:each="row : ${puntajes}">
                <a th:href="@{|/juegos/${row.juegoId}|}" class="card-link">

                    <div class="card-cover-wrapper">
                        <div class="card-cover"
                             th:if="${row.portada != null}"
                             th:style="'background-image: url(' + ${row.portada} + ');'">
                            <div class="card-hover">
                                <span>Ver detalle</span>
                            </div>
                        </div>

                        <div class="card-cover placeholder" th:if="${row.portada == null}">
                            <span>Sin portada</span>
                        </div>
                    </div>

                    <div class="card-body">
                        <h3 th:text="${row.titulo}">Título del juego</h3>
                        <p class="meta">
                            <span class="label">Puntaje promedio:</span>
                            <span th:text="${#numbers.formatDecimal(row.puntajePromedio, 1, 2)}">9.50</span>
                        </p>
                    </div>
                </a>
            </div>
        </div>
    </section>

</div>

</body>
</html>